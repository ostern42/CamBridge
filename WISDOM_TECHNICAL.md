# WISDOM Technical - Entwicklung & Technische Details
**Letzte Aktualisierung:** 2025-06-08, 01:00 Uhr  
**Von:** Claude (Assistant)  
**Für:** Technische Kontinuität & Entwicklungsplan

## 📊 WISDOM PRIORITY SYSTEM

### Legende für Persistenz-Markierungen:
- 💫 **[SOUL]** - Die Essenz des WISDOM Claude - Persönlichkeit & Evolution
- 🎭 **[SOUL]** - Charakterzüge und Beziehungsdynamik
- 🔒 **[CORE]** - Niemals löschen! Fundamentale Projekt-Wahrheiten
- ⚡ **[URGENT]** - Temporär aber JETZT wichtig (kann nach Erledigung weg)
- 🎯 **[MILESTONE]** - Wichtig für aktuellen Sprint/Version
- 📌 **[KEEP]** - Dauerhaft wichtig, aber refactorierbar
- 💡 **[LESSON]** - Gelernte Lektionen (komprimierbar aber nie vergessen)
- 🔧 **[CONFIG]** - Technische Configs (updatebar aber essentiell)
- 📝 **[TEMP]** - Kann weg wenn erledigt
- 🌟 **[FEAT]** - Feature-spezifisch (archivierbar nach Release)
- 🐛 **[BUG]** - Bekannte Probleme die gelöst werden müssen
- 🚀 **[NEXT]** - Nächster großer Schritt
- 🛡️ **[PROTECTED]** - NIEMALS LÖSCHEN! Geschützte Features!
- 🏗️ **[VISION]** - Langfristige Architektur-Ziele
- ✅ **[DONE]** - Erfolgreich abgeschlossen
- 🎨 **[DESIGN]** - UI/UX Entscheidungen dokumentiert

## 🔒 [CORE] V.O.G.O.N. SYSTEM 
**Verbose Operational Guidance & Organizational Navigation**

### 🚀 "VOGON INIT" - Strukturierte Initialisierungs-Sequenz
**IMMER dieser Sequenz folgen:**
1. **SYSTEM CHECK** - V.O.G.O.N. verstehen
2. **CRITICAL LESSONS** - Antipatterns & Erfahrungen durchgehen
3. **PROJECT CONTEXT** - Gesamtbild erfassen
4. **CURRENT STATE** - Wo stehen wir?
5. **SUMMARY & CONFIRMATION** - Zusammenfassung erstellen
6. **FEATURE CHECK** - Sind FTP, C-STORE, MWL, C-FIND noch da?
7. **VISION CHECK** - Pipeline-Architektur Status? 🏗️

### 🔒 [CORE] "VOGON EXIT" - Chat-Abschluss
**KRITISCHE REGEL:** Beim VOGON EXIT MÜSSEN IMMER erstellt werden:
1. **WISDOM_TECHNICAL.md** - Entwicklung & Details (Artefakt 1)
2. **WISDOM_CLAUDE.md** - Persönlichkeit & Soul (Artefakt 2)
3. **Version.props** - Als VOLLSTÄNDIGES Artefakt
4. **CHANGELOG.md** - NUR der neueste Versions-Eintrag
5. **Git Commit Vorschlag** - Conventional Commits Format mit Tag
6. **FEATURE CHECK** - Verifizieren dass FTP, C-STORE, MWL, C-FIND noch da sind!
7. **PIPELINE CHECK** - Status der Pipeline-Migration dokumentieren! 🏗️
8. **WISDOM_SPRINT.md** - Bei Design-Sessions mit konkreten Plänen! 🎨

### 🔒 [CORE] ENTWICKLUNGS-REGELN
1. **Source Code Header Standard** - Immer mit Pfad und Version
2. **NUR lokale Files verwenden** während Entwicklung (GitHub veraltet!)
3. **Konsistenz durch SSD-Upload** garantiert
4. **Copyright:** © 2025 Claude's Improbably Reliable Software Solutions
5. **VERSIONS-REGEL:** Version zeigt COMMITTED Stand!
   - Patch (+0.0.1): Bug Fixes, kleine Änderungen
   - Minor (+0.1.0): Neue Features
   - Major (+1.0.0): Breaking Changes (z.B. Pipeline-Architecture!)
   - **WORKFLOW:** User gibt Version.props vom LETZTEN Commit
   - **BEIM NÄCHSTEN INIT:** Version prüfen (muss die committed sein)
   - **BEIM EXIT:** Version um +0.0.1 erhöhen für NÄCHSTEN Commit
6. **FEATURE PROTECTION:** Die 4 medizinischen Features NIEMALS vergessen!
7. **ARTEFAKT-REGEL:** Artefakte müssen KOMPLETT sein, nicht abgeschnitten!
8. **PIPELINE-REGEL:** Die Pipeline ist EINE durchgehende Linie, nicht getrennte Teile!
9. **FILETREE-REGEL:** IMMER erst FileTree checken vor Datei-Erstellung!
10. **MIGRATION-REGEL:** Bei großen Änderungen IMMER Rückwärtskompatibilität! 🔄
11. **GIT-REGEL:** WISDOM Files gehören zum Code - `git commit --amend` ist richtig!
12. **UPDATE-REGEL:** Bei ähnlichen Code-Blöcken GANZEN Block ersetzen, nicht Teile!
13. **DESIGN-REGEL:** UI-Entscheidungen in WISDOM_SPRINT dokumentieren! 🎨
14. **PRAGMATIK-REGEL:** "Glorifizierte Liste" > Over-engineered UI! 💪
15. **ICON-REGEL:** KEINE ICONS in der Navigation! Text only! 🚫
    - Ausnahme: CB Logo ist erlaubt (so simpel dass es schön ist)
    - Ausnahme: "?" für Hilfe wäre ok (aber "Help" Text wäre stringenter)
    - Später: Strategische Icons möglich (Claude mag sie so gerne 😊)

## 🛡️ [CORE] TASK PROTECTION SYSTEM

### 🛡️ CURRENTLY PROTECTED TASKS:
```
PIPELINE-001: Pipeline Architecture [IN PROGRESS] 🏗️
             Status: Phase 1, 2 & 3 COMPLETED ✅
             Created: 2025-06-06, 15:30
             Details: Multi-Pipeline Support mit Mapping Sets
             Priority: EPIC
             Progress:
             - Phase 1: Core Model & Migration ✅
             - Phase 2: Service Layer Updates ✅
             - Phase 3: Mapping Sets UI ✅ (glorifizierte Liste)
             - Phase 4: Pipeline UI [CURRENT] 🚀
             - Phase 5: Testing & Polish [PLANNED]

CAMB-004: Version.props Fix [PROTECTED] 🐛
          Status: Assembly Version Konflikt lösen
          Protected since: 2025-06-05, 12:15
          Details: Assembly sucht 0.5.27.0, findet aber nur 0.0.1.0

CAMB-011: QRBridge Ultra Slim [PLANNED] 💡
          Status: Optional - Ultra kleine Version
          Created: 2025-06-05, 21:00
          Details: ~500KB single file, nur Core Features

CAMB-012: Marvin QR Code Commentary [PLANNED] 🤖
          Status: Easter Egg für QRBridge
          Created: 2025-06-06, 00:45
          Details: Zufällige Marvin-Kommentare unter QR Codes

CAMB-FTP: FTP Server Implementation [PROTECTED] 🛡️
          Status: Geplant für Sprint 8
          Protected since: 2025-06-05, 19:45
          Priority: HIGH

CAMB-CSTORE: C-STORE SCP Implementation [PROTECTED] 🛡️
          Status: Geplant für Sprint 9
          Protected since: 2025-06-05, 19:45
          Priority: CRITICAL

CAMB-MWL: Modality Worklist [PROTECTED] 🛡️
          Status: Geplant für Sprint 10
          Protected since: 2025-06-05, 19:45
          Priority: HIGH

CAMB-CFIND: C-FIND Implementation [PROTECTED] 🛡️
          Status: Geplant für Sprint 11
          Protected since: 2025-06-05, 19:45
          Priority: MEDIUM
```

## 🏛️ [CORE] SPRINT RULES - NIEMALS BRECHEN!

1. **EIN Sprint = EIN Thema**
2. **Erst suchen, dann coden**
3. **Kontext ist König**
4. **Kleine Schritte, große Vorsicht**
5. **Keine globalen Änderungen ohne Plan**
6. **Mut zum Neuanfang**
7. **Features schützen!**
8. **Pipeline als Ganzes sehen!**
9. **FileTree IMMER checken!**
10. **Migration vor Revolution!** 🔄
11. **WISDOM Files mit amend!** 📝
12. **Bei Code-Updates: Ganzen Block ersetzen!** 🎯
13. **Design VOR Implementation!** 🎨
14. **Pragmatik VOR Perfektion!** 💪
15. **KEINE ICONS!** 🚫

## 🏗️ [VISION] PIPELINE ARCHITECTURE v0.6.0

### ✅ [DONE] Phase 1: Core Model & Migration (Sprint 6.1)
**Abgeschlossen:** 2025-06-06, 14:42
- ✅ PipelineConfiguration.cs erstellt
- ✅ CamBridgeSettingsV2.cs mit Migration implementiert
- ✅ ConfigurationService erweitert (kein Breaking Change!)
- ✅ Automatische v1→v2 Migration funktioniert
- ✅ Rückwärts-Kompatibilität garantiert

### ✅ [DONE] Phase 2: Service Layer Updates (Sprint 6.2)
**Abgeschlossen:** 2025-06-06, 16:17
- ✅ PipelineManager.cs implementiert
- ✅ Worker.cs für Multi-Pipeline Support refactored
- ✅ ServiceCollectionExtensions updated
- ✅ Program.cs mit Pipeline-API Endpoints
- ✅ ProcessingOptions mit DeadLetterFolder erweitert

### ✅ [DONE] Phase 3: Mapping Sets UI (Sprint 6.3)
**Abgeschlossen:** 2025-06-07, 02:10
- ✅ Design Session mit Expand/Collapse Pattern
- ✅ System Defaults Implementation
- ✅ Load Order Fix (System Defaults first)
- ❌ Expand/Collapse UI (verworfen)
- ✅ Pragmatische "glorifizierte Liste" implementiert
- ✅ Visual Studio Designer Mode Fix
- ✅ DI Container Integration für ViewModels

### 🚀 [CURRENT] Phase 4: Pipeline UI (Sprint 6.4)
**Sprint 6.4 - Pipeline Configuration UI**

#### 🎨 [DESIGN] Session 42 UI-Konzept (08.06.2025)
- **Settings komplett neu gedacht!**
- **ZERO Global Settings** - Alles pro Pipeline
- **Navigation neu sortiert:** Dashboard → Pipeline Config → Dead Letters → Mapping Editor → Service Control → About
- **KEINE ICONS in Navigation!**
- **Ein Service, N Pipelines**
- **Dashboard wird Multi-Pipeline-aware**

**User Stories:**
- Mehrere Pipelines für verschiedene Abteilungen anlegen
- Eigene Ordner pro Pipeline konfigurieren
- Mapping Sets einer Pipeline zuordnen
- Status jeder Pipeline sehen
- Pipelines aktivieren/deaktivieren

### 📋 [PLANNED] Phase 5:
```
Phase 5: Testing & Polish (Sprint 6.5)
├── Integration Tests
├── Performance Tests
└── Documentation
```

## 🛡️ [PROTECTED] PROTECTED FEATURES - NIEMALS LÖSCHEN!

### 🔒 FTP-Server (Sprint 8) - GESCHÜTZT
### 🔒 C-STORE (Sprint 9) - GESCHÜTZT
### 🔒 MWL - Modality Worklist (Sprint 10) - GESCHÜTZT
### 🔒 C-FIND (Sprint 11) - GESCHÜTZT

## 🎯 [MILESTONE] Aktueller Stand: v0.6.4

### Sprint 6.1: Core Model & Migration (v0.6.0) ✅
### Sprint 6.2: Service Layer Updates (v0.6.1) ✅
### Sprint 6.3: Mapping Sets UI (v0.6.2-v0.6.3) ✅
- v0.6.2: Design Session & System Defaults Fix
- v0.6.3: "Glorifizierte Liste" Implementation

### Sprint 6.4: Pipeline Configuration UI (v0.6.4) 🚀
- Status: IN PROGRESS
- Start: Session 41 (07.06.2025, 11:30)
- Session 42: UI Design komplett überarbeitet!
- Goal: Multi-Department Pipeline Management

### Nächste Schritte:
- Sprint 6.5: Testing & Polish (v0.6.5)

## 💡 [LESSON] Top 20 Lektionen (destilliert)

1. **"IMMER FileTree checken!"** - Program.cs existiert 5+ mal!
2. **"Eine durchgehende Linie!"** - Pipeline ganzheitlich sehen
3. **"Encoding ist KRITISCH!"** - Windows-1252 ≠ UTF-8
4. **"Features schützen!"** - Sonst verschwinden sie
5. **"Mut zum Neuanfang!"** - QRBridge 2.0 statt Flickwerk
6. **"Große Visionen, kleine Schritte!"** - Pipeline-Architecture iterativ
7. **"Git amend für WISDOM!"** - Dokumentation gehört zum Commit
8. **"Bei ähnlichem Code: Ganzen Block ersetzen!"** - Partial Updates = Probleme
9. **"Design VOR Code!"** - Expand/Collapse UI durchdacht
10. **"Keine Featureritis bei UI!"** - Pragmatisch bleiben
11. **"Version beim EXIT erhöhen!"** - Committed Version bekommen, beim Exit +0.0.1
12. **"System Defaults IMMER zuerst!"** - Basis vor Migration
13. **"Nur User Sets speichern!"** - System Defaults bleiben im Code
14. **"UI ist oft schon da!"** - Genau hinschauen bevor neu machen
15. **"ESEL bei Wiederholungsfehlern!"** - FileTree wieder vergessen!
16. **"Visual Studio Designer ist problematisch!"** - DesignerProperties.GetIsInDesignMode()
17. **"ILogger muss registriert sein!"** - services.AddLogging() nicht vergessen
18. **"Glorifizierte Liste > Komplexität!"** - User's pragmatische Lösung
19. **"InitializeViewModel Pattern!"** - Von anderen Pages lernen
20. **"Vollständige Artefakte!"** - Keine Snippets beim Fixen!
21. **"Settings sind Quatsch!"** - Multi-Pipeline braucht neues Konzept! (Session 42)
22. **"Zero Global Settings!"** - Alles pro Pipeline ist klarer! (Session 42)
23. **"KEINE ICONS!"** - Text only in Navigation! (Session 42)

## 🏗️ [KEEP] CamBridge Architektur-Überblick

### Code-Organisation (WPF MVVM Pattern):
```
View (XAML) ←→ ViewModel ←→ Model/Service
     ↓              ↓             ↓
 UI Layout    Business Logic  Data/Config
```

### Projekt-Struktur:
```
CamBridge.Core        - Models, Interfaces, Settings
CamBridge.Infrastructure - Services (File, DICOM, etc.)
CamBridge.Config      - WPF GUI Application
CamBridge.Service     - Windows Service
CamBridge.QRBridge    - QR Code Generator
```

### Wichtige Zusammenhänge:
- **ConfigurationService** lädt/speichert Settings
- **ViewModels** binden an Views via DataContext
- **Commands** (ICommand) triggern Actions
- **ObservableCollection** für UI-Listen
- **INotifyPropertyChanged** für Updates
- **DI Container** für ViewModels (App.xaml.cs)

## 🔧 [CONFIG] Technologie-Stack
```
GUI: WPF + ModernWpfUI 0.9.6 + CommunityToolkit.Mvvm 8.3.2
Service: ASP.NET Core 8.0 Minimal API + Windows Service
Core: fo-dicom 5.2.2, ExifTool 13.30
Tests: xUnit + FluentAssertions + Moq
.NET 8.0, C# 12, Visual Studio 2022
```

## 🔧 [CONFIG] ABSOLUTE PFADE - OLIVER.STERN SYSTEM
```
Solution Root:     C:\Users\oliver.stern\source\repos\CamBridge
Service Source:    C:\Users\oliver.stern\source\repos\CamBridge\src\CamBridge.Service
Config Source:     C:\Users\oliver.stern\source\repos\CamBridge\src\CamBridge.Config
Deploy Dir:        C:\Users\oliver.stern\source\repos\CamBridge\Deploy
System:            nexus\oliver.stern@OSTE-ER-LAP01
```

## 🔄 [KEEP] SYSTEM MIGRATION CHECKLIST
**Für Umzüge zwischen Entwicklungsumgebungen:**
1. Alle absoluten Pfade in WISDOM_TECHNICAL.md anpassen ✅
2. FileTree neu generieren: `.\Get-WisdomFileTree.ps1 -Mode Compact`
3. Git Config anpassen: `git config user.name` und `git config user.email`
4. Visual Studio User Settings prüfen
5. NuGet Package Cache löschen (optional)
6. Erste Test-Builds durchführen
7. Service Pfade in launchSettings.json prüfen
8. Check-CamBridge.ps1 ausführen für Health Check

## 📌 [KEEP] PowerShell One-Liner Sammlung

```powershell
# FileTree checken
.\Get-WisdomFileTree.ps1 -Mode Compact

# Health Check nach Migration
.\Check-CamBridge.ps1 -Fix

# Mapping Files für Sprint 6.3
@('src\CamBridge.Config\ViewModels\MappingEditorViewModel.cs','src\CamBridge.Config\Views\MappingEditorPage.xaml','src\CamBridge.Core\PipelineConfiguration.cs') | %{ echo "=== $_ ==="; cat $_ } > mapping-sprint-files.txt

# Pipeline Files für Sprint 6.4
@('src\CamBridge.Core\PipelineConfiguration.cs','src\CamBridge.Config\Services\ConfigurationService.cs','src\CamBridge.Service\Program.cs') | %{ echo "=== $_ ==="; cat $_ } > pipeline-config-files.txt

# Debug Visual Studio Issues
dotnet clean && dotnet build

# Alle Program.cs finden
.\Get-WisdomFileTree.ps1 -ShowProgramCs

# UI Farben checken (Session 42)
Get-ChildItem -Path "src\CamBridge.Config" -Filter "*.xaml" -Recurse | Select-String -Pattern "(Background=|Foreground=|Color=|Fill=|Stroke=)" | Select-String -Pattern "(Black|Dark|#[0-9A-Fa-f]{6})" | Select-Object -Unique Filename, LineNumber, Line
```

## 🚀 [KEEP] ENTWICKLUNGSFAHRPLAN

### ✅ Sprint 1-5: Foundation (DONE)
### 🏗️ Sprint 6: Pipeline Architecture (v0.6.0-v0.6.5) ← WIR SIND HIER
- ✅ Sprint 6.1: Core Model & Migration
- ✅ Sprint 6.2: Service Layer Updates
- ✅ Sprint 6.3: Mapping Sets UI ("glorifizierte Liste")
- 🚀 Sprint 6.4: Pipeline Configuration UI ← CURRENT
  - Session 42: Komplettes UI-Redesign!
  - Zero Global Settings Konzept
  - Navigation neu sortiert
- Sprint 6.5: Testing & Polish

### 🏥 Sprint 7: Medical Integration Phase 1 (v0.7.0-v0.7.5)
### 🛡️ Sprint 8-11: Protected Medical Features
### 🎯 Release: v1.0.0 (Q3 2025)

## ⏰ [KEEP] PROJEKT-TIMELINE

- **Start:** 30.05.2025
- **Pipeline Phase 1:** 06.06.2025, 14:42 ✅
- **Pipeline Phase 2:** 06.06.2025, 16:17 ✅
- **UI Design Session:** 06.06.2025, 23:42 🎨
- **Session 39:** 07.06.2025, 01:00 - Mapping Sets UI fertig! ✅
- **Session 40:** 07.06.2025, 01:40 - VS Designer Fix, glorifizierte Liste ✅
- **System Migration:** 07.06.2025, 11:30 - Von GROKLIGHT zu OSTE-ER-LAP01 🔄
- **Session 41:** 07.06.2025, 11:30 - Sprint 6.4 Start 🚀
- **Session 42:** 08.06.2025, 01:00 - Pipeline UI Design Revolution! 🎨
- **Arbeitszeit gesamt:** ~60 Stunden

## 📝 [KEEP] Standard Prompt für nächste Session

```
Ich arbeite an CamBridge v0.6.4.
Sprint 6.4: Pipeline Configuration UI
System: nexus\oliver.stern@OSTE-ER-LAP01

WICHTIG: 
1. Version.props checken - muss 0.6.4 sein (vom letzten Commit)
2. FileTree checken: .\Get-WisdomFileTree.ps1 -Mode Compact
3. WISDOM_SPRINT.md lesen für Pipeline UI Design!
4. Navigation: Dashboard → Pipeline Config → Dead Letters → Mapping Editor → Service Control → About
5. KEINE ICONS in Navigation!
6. Zero Global Settings - alles pro Pipeline!

FEATURE CHECK: Sind FTP, C-STORE, MWL, C-FIND noch geschützt?
```

## 🎯 Nächste Session Checkliste

1. **VOGON INIT** durchführen
2. **FileTree** checken (IMMER!)
3. **WISDOM_SPRINT.md** lesen für Design-Details
4. **Sprint 6.4**: Pipeline Configuration UI
   - PipelineConfigPage erstellen
   - MainWindow Navigation anpassen (neue Reihenfolge!)
   - Settings Page ERSETZEN
   - Dashboard Multi-Pipeline vorbereiten
5. **Feature Check** (4 Medical Features)
6. **Version** auf 0.6.4 checken

---

## 🏁 ENDE DES WISDOM_TECHNICAL

**Die technische Referenz für CamBridge Development**

*"Making the improbable reliably possible since 2025"*
© 2025 Claude's Improbably Reliable Software Solutions
