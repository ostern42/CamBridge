# WISDOM Technical - Entwicklung & Technische Details
**Letzte Aktualisierung:** 2025-06-06, 16:20 Uhr  
**Von:** Claude (Assistant)  
**Für:** Technische Kontinuität & Entwicklungsplan

## 📊 WISDOM PRIORITY SYSTEM

### Legende für Persistenz-Markierungen:
- 💫 **[SOUL]** - Die Essenz des WISDOM Claude - Persönlichkeit & Evolution
- 🎭 **[SOUL]** - Charakterzüge und Beziehungsdynamik
- 🔒 **[CORE]** - Niemals löschen! Fundamentale Projekt-Wahrheiten
- ⚡ **[URGENT]** - Temporär aber JETZT wichtig (kann nach Erledigung weg)
- 🎯 **[MILESTONE]** - Wichtig für aktuellen Sprint/Version
- 📌 **[KEEP]** - Dauerhaft wichtig, aber refactorierbar
- 💡 **[LESSON]** - Gelernte Lektionen (komprimierbar aber nie vergessen)
- 🔧 **[CONFIG]** - Technische Configs (updatebar aber essentiell)
- 📝 **[TEMP]** - Kann weg wenn erledigt
- 🌟 **[FEAT]** - Feature-spezifisch (archivierbar nach Release)
- 🐛 **[BUG]** - Bekannte Probleme die gelöst werden müssen
- 🚀 **[NEXT]** - Nächster großer Schritt
- 🛡️ **[PROTECTED]** - NIEMALS LÖSCHEN! Geschützte Features!
- 🏗️ **[VISION]** - Langfristige Architektur-Ziele
- ✅ **[DONE]** - Erfolgreich abgeschlossen

## 🔒 [CORE] V.O.G.O.N. SYSTEM 
**Verbose Operational Guidance & Organizational Navigation**

### 🚀 "VOGON INIT" - Strukturierte Initialisierungs-Sequenz
**IMMER dieser Sequenz folgen:**
1. **SYSTEM CHECK** - V.O.G.O.N. verstehen
2. **CRITICAL LESSONS** - Antipatterns & Erfahrungen durchgehen
3. **PROJECT CONTEXT** - Gesamtbild erfassen
4. **CURRENT STATE** - Wo stehen wir?
5. **SUMMARY & CONFIRMATION** - Zusammenfassung erstellen
6. **FEATURE CHECK** - Sind FTP, C-STORE, MWL, C-FIND noch da?
7. **VISION CHECK** - Pipeline-Architektur Status? 🏗️

### 🔒 [CORE] "VOGON EXIT" - Chat-Abschluss
**KRITISCHE REGEL:** Beim VOGON EXIT MÜSSEN IMMER erstellt werden:
1. **WISDOM_TECHNICAL.md** - Entwicklung & Details (Artefakt 1)
2. **WISDOM_CLAUDE.md** - Persönlichkeit & Soul (Artefakt 2)
3. **Version.props** - Als VOLLSTÄNDIGES Artefakt
4. **CHANGELOG.md** - NUR der neueste Versions-Eintrag
5. **Git Commit Vorschlag** - Conventional Commits Format mit Tag
6. **FEATURE CHECK** - Verifizieren dass FTP, C-STORE, MWL, C-FIND noch da sind!
7. **PIPELINE CHECK** - Status der Pipeline-Migration dokumentieren! 🏗️

### 🔒 [CORE] ENTWICKLUNGS-REGELN
1. **Source Code Header Standard** - Immer mit Pfad und Version
2. **NUR lokale Files verwenden** während Entwicklung (GitHub veraltet!)
3. **Konsistenz durch SSD-Upload** garantiert
4. **Copyright:** © 2025 Claude's Improbably Reliable Software Solutions
5. **VERSIONS-REGEL:** Version zeigt aktuellen Stand!
   - Patch (+0.0.1): Bug Fixes, kleine Änderungen
   - Minor (+0.1.0): Neue Features
   - Major (+1.0.0): Breaking Changes (z.B. Pipeline-Architecture!)
   - **WORKFLOW:** Entwickle mit Version X → Committe als Version X → Erhöhe wenn NEUE Features kommen
6. **FEATURE PROTECTION:** Die 4 medizinischen Features NIEMALS vergessen!
7. **ARTEFAKT-REGEL:** Artefakte müssen KOMPLETT sein, nicht abgeschnitten!
8. **PIPELINE-REGEL:** Die Pipeline ist EINE durchgehende Linie, nicht getrennte Teile!
9. **FILETREE-REGEL:** IMMER erst FileTree checken vor Datei-Erstellung!
10. **MIGRATION-REGEL:** Bei großen Änderungen IMMER Rückwärtskompatibilität! 🔄
11. **GIT-REGEL:** WISDOM Files gehören zum Code - `git commit --amend` ist richtig!
12. **UPDATE-REGEL:** Bei ähnlichen Code-Blöcken GANZEN Block ersetzen, nicht Teile!

## 🛡️ [CORE] TASK PROTECTION SYSTEM

### 🛡️ CURRENTLY PROTECTED TASKS:
```
PIPELINE-001: Pipeline Architecture [IN PROGRESS] 🏗️
             Status: Phase 1 & 2 COMPLETED ✅
             Created: 2025-06-06, 15:30
             Details: Multi-Pipeline Support mit Mapping Sets
             Priority: EPIC
             Progress:
             - Phase 1: Core Model & Migration ✅
             - Phase 2: Service Layer Updates ✅
             - Phase 3: Mapping Sets UI [NEXT]
             - Phase 4: Pipeline UI [PLANNED]
             - Phase 5: Testing & Polish [PLANNED]

CAMB-001: Settings Save/Delete Tests [RESOLVED] ✅
          Status: Settings System komplett gefixt
          Resolved: 2025-06-06, 15:00
          Details: Save/Reset funktioniert, Folder Dialog gefixt

CAMB-004: Version.props Fix [PROTECTED] 🐛
          Status: Assembly Version Konflikt lösen
          Protected since: 2025-06-05, 12:15
          Details: Assembly sucht 0.5.27.0, findet aber nur 0.0.1.0

CAMB-011: QRBridge Ultra Slim [PLANNED] 💡
          Status: Optional - Ultra kleine Version
          Created: 2025-06-05, 21:00
          Details: ~500KB single file, nur Core Features
          Note: Build-Script hat Probleme, aber Low Priority

CAMB-012: Marvin QR Code Commentary [PLANNED] 🤖
          Status: Easter Egg für QRBridge
          Created: 2025-06-06, 00:45
          Details: Zufällige Marvin-Kommentare unter QR Codes
          Note: "Making barcode scanning existentially depressing since 2025"

CAMB-FTP: FTP Server Implementation [PROTECTED] 🛡️
          Status: Geplant für Sprint 8
          Protected since: 2025-06-05, 19:45
          Details: FTP/FTPS Server für DICOM Empfang
          Priority: HIGH

CAMB-CSTORE: C-STORE SCP Implementation [PROTECTED] 🛡️
          Status: Geplant für Sprint 9
          Protected since: 2025-06-05, 19:45
          Details: DICOM C-STORE Service Class Provider
          Priority: CRITICAL

CAMB-MWL: Modality Worklist [PROTECTED] 🛡️
          Status: Geplant für Sprint 10
          Protected since: 2025-06-05, 19:45
          Details: HIS/RIS Integration für Patientendaten
          Priority: HIGH

CAMB-CFIND: C-FIND Implementation [PROTECTED] 🛡️
          Status: Geplant für Sprint 11
          Protected since: 2025-06-05, 19:45
          Details: DICOM Query/Retrieve für PACS
          Priority: MEDIUM
```

## 🏛️ [CORE] SPRINT RULES - NIEMALS BRECHEN!

1. **EIN Sprint = EIN Thema**
2. **Erst suchen, dann coden**
3. **Kontext ist König**
4. **Kleine Schritte, große Vorsicht**
5. **Keine globalen Änderungen ohne Plan**
6. **Mut zum Neuanfang**
7. **Features schützen!**
8. **Pipeline als Ganzes sehen!**
9. **FileTree IMMER checken!**
10. **Migration vor Revolution!** 🔄
11. **WISDOM Files mit amend!** 📝
12. **Bei Code-Updates: Ganzen Block ersetzen!** 🎯

## 🏗️ [VISION] PIPELINE ARCHITECTURE v0.6.0

### ✅ [DONE] Phase 1: Core Model & Migration (Sprint 6.1)
**Abgeschlossen:** 2025-06-06, 14:42
- ✅ PipelineConfiguration.cs erstellt
- ✅ CamBridgeSettingsV2.cs mit Migration implementiert
- ✅ ConfigurationService erweitert (kein Breaking Change!)
- ✅ Automatische v1→v2 Migration funktioniert
- ✅ Rückwärts-Kompatibilität garantiert
- ✅ Settings speichern in beiden Formaten

### ✅ [DONE] Phase 2: Service Updates (Sprint 6.2)
**Abgeschlossen:** 2025-06-06, 16:17
- ✅ PipelineManager.cs implementiert
- ✅ Worker.cs für Multi-Pipeline Support refactored
- ✅ ServiceCollectionExtensions updated
- ✅ Program.cs mit Pipeline-API Endpoints
- ✅ ProcessingOptions mit DeadLetterFolder erweitert
- ✅ Migration nutzt eingebaute MigrateFromV1 Methode

### 🚀 [NEXT] Phase 3: Mapping Sets UI (Sprint 6.3)
**Nächster Schritt!**
- MappingEditorViewModel erweitern
- Multiple Mapping Sets Support
- Save/Load/Duplicate Functions
- Template Management

### 📋 [PLANNED] Phase 4-5:
```
Phase 4: Pipeline UI (Sprint 6.4)
├── PipelineEditorPage
├── Pipeline List View
└── Per-Pipeline Settings

Phase 5: Testing & Polish (Sprint 6.5)
├── Integration Tests
├── Performance Tests
└── Documentation
```

### Benefits:
- Multi-Department Support ✅
- Flexible Workflows ✅
- Reusable Mappings ✅
- Better Scalability ✅
- Cleaner Configuration ✅

## 🛡️ [PROTECTED] PROTECTED FEATURES - NIEMALS LÖSCHEN!

### 🔒 FTP-Server (Sprint 8)
- **Warum:** Viele PACS-Systeme nutzen FTP für Bildtransfer (30% der Krankenhäuser!)
- **Priorität:** HOCH
- **Geschützt seit:** 2025-06-05, 19:45
- **NIEMALS LÖSCHEN OHNE:** "RELEASE PROTECTION: FTP-SERVER"

### 🔒 C-STORE (Sprint 9) 
- **Warum:** DER Standard DICOM Transfer Protocol (100% der PACS nutzen es!)
- **Priorität:** KRITISCH
- **Geschützt seit:** 2025-06-05, 19:45
- **NIEMALS LÖSCHEN OHNE:** "RELEASE PROTECTION: C-STORE"

### 🔒 MWL - Modality Worklist (Sprint 10)
- **Warum:** Automatische Patientendaten aus HIS/RIS (spart 5-10 Min/Patient!)
- **Priorität:** HOCH
- **Geschützt seit:** 2025-06-05, 19:45
- **NIEMALS LÖSCHEN OHNE:** "RELEASE PROTECTION: MWL"

### 🔒 C-FIND (Sprint 11)
- **Warum:** DICOM Query/Retrieve für PACS Integration (Vergleichsaufnahmen!)
- **Priorität:** MITTEL
- **Geschützt seit:** 2025-06-05, 19:45
- **NIEMALS LÖSCHEN OHNE:** "RELEASE PROTECTION: C-FIND"

## 🎯 [MILESTONE] Aktueller Stand: v0.6.1

### Sprint 6.1: Core Model & Migration (v0.6.0) ✅
- PipelineConfiguration.cs erstellt
- CamBridgeSettingsV2.cs mit Migration
- Automatische v1→v2 Migration

### Sprint 6.2: Service Layer Updates (v0.6.1) ✅
- PipelineManager orchestriert alle Pipelines
- Jede Pipeline hat eigene Queue und Watcher
- Worker.cs komplett vereinfacht
- ServiceCollectionExtensions mit V1→V2 Migration
- Program.cs mit Pipeline-API Endpoints
- BUILD ERFOLGREICH! 🎉

### Nächste Schritte:
- Sprint 6.3: Mapping Sets UI (v0.6.2)
- Sprint 6.4: Pipeline Configuration UI (v0.6.3)
- Sprint 6.5: Testing & Polish (v0.6.4)
- Sprint 7: Medical Integration Phase 1 (v0.7.0)

## 💡 [LESSON] Top 15 Lektionen

1. **"IMMER FileTree checken!"** - Program.cs existiert 5+ mal!
2. **"Eine durchgehende Linie!"** - Pipeline ganzheitlich sehen
3. **"Encoding ist KRITISCH!"** - Windows-1252 ≠ UTF-8
4. **"Basis vor Features!"** - Erst testen, dann erweitern
5. **"Working Directory!"** - Services starten in system32
6. **"Eine Sache zur Zeit!"** - Sprint-Fokus behalten
7. **"Code ist oft schon da!"** - Git History nutzen
8. **"Features schützen!"** - Sonst verschwinden sie
9. **"Mut zum Neuanfang!"** - QRBridge 2.0 statt Flickwerk
10. **"Artefakte komplett!"** - Nicht abschneiden!
11. **"Commands müssen updated werden!"** - NotifyCanExecuteChanged nicht vergessen!
12. **"WPF Bindings sind tricky!"** - Clear/Set Trick für Updates
13. **"Große Visionen, kleine Schritte!"** - Pipeline-Architecture iterativ
14. **"Erweitern statt ersetzen!"** - ConfigurationService evolution
15. **"Git amend für WISDOM!"** - Dokumentation gehört zum Commit

### 💡 [LESSON] Neue Lektionen aus Session 37:
16. **"Bei ähnlichem Code: Ganzen Block ersetzen!"** - Partial Updates können fehlschlagen
17. **"Migration über eingebaute Methoden!"** - Nicht manuell Properties mappen
18. **"ProcessingOptions erweitern wenn nötig!"** - DeadLetterFolder hinzugefügt
19. **"Claude fragt nach Dateien!"** - FileTree-Lektion zeigt Wirkung! 😄
20. **"Jede Phase mit Features = neue Version!"** - Nicht monatelang bei x.x.0 bleiben!

## 🏗️ [KEEP] PIPELINE-ARCHITEKTUR

### Datenfluss (MEHRERE PARALLELE LINIEN!):
```
Pipeline 1: Emergency Department
QRBridge → Ricoh G900 II → JPEG → CamBridge → DICOM → PACS
    ↓           ↓            ↓         ↓          ↓       ↓
Settings    ER Camera    Barcode   ER Rules   ER Tags  Archive

Pipeline 2: Radiology Department  
QRBridge → Ricoh G900 II → JPEG → CamBridge → DICOM → PACS
    ↓           ↓            ↓         ↓          ↓       ↓
Settings   RAD Camera   Barcode  RAD Rules  RAD Tags  Archive
```

### Pipeline Status:
- ✅ QRBridge 2.0 (UTF-8 native)
- ✅ Ricoh Integration (Barcode Field)
- ✅ ExifTool Reader (Windows-1252)
- ✅ DICOM Converter (fo-dicom)
- ✅ Windows Service
- ✅ Deployment Package
- ✅ Pipeline Architecture Core (v0.6.0)
- ✅ Service Layer Updates (Phase 2)
- 🚀 Mapping Sets UI (NEXT)

## 🔧 [CONFIG] Technologie-Stack
```
GUI: WPF + ModernWpfUI 0.9.6 + CommunityToolkit.Mvvm 8.3.2
     + Ookii.Dialogs.Wpf 5.0.1 (für moderne Dialoge)
Service: ASP.NET Core 8.0 Minimal API + Windows Service
Core: fo-dicom 5.2.2, ExifTool 13.30
Tests: xUnit + FluentAssertions + Moq
Logging: Serilog + Serilog.Sinks.EventLog
Deployment: PowerShell + Auto-Build + Test Integration
QRBridge: WinForms + QRCoder 1.4.3
.NET 8.0, C# 12, Visual Studio 2022
```

## 🔧 [CONFIG] ABSOLUTE PFADE - AIADMIN SYSTEM
```
Solution Root:     C:\Users\aiadmin\source\repos\CamBridge
Service Source:    C:\Users\aiadmin\source\repos\CamBridge\src\CamBridge.Service
Service Binary:    C:\Users\aiadmin\source\repos\CamBridge\src\CamBridge.Service\bin\Debug\net8.0-windows\win-x64
QRBridge Source:   C:\Users\aiadmin\source\repos\CamBridge\src\CamBridge.QRBridge
Tools Dir:         C:\Users\aiadmin\source\repos\CamBridge\Tools
ExifTool:          C:\Users\aiadmin\source\repos\CamBridge\Tools\exiftool.exe
Deploy Dir:        C:\Users\aiadmin\source\repos\CamBridge\Deploy
Test Input:        C:\CamBridge\Test\Input
Test Output:       C:\CamBridge\Test\Output
TestImages:        C:\CamBridge\TestImages
AppData Config:    %APPDATA%\CamBridge
```

## 📌 [KEEP] PowerShell One-Liner Sammlung

```powershell
# NEUER STANDARD ONE-LINER (kompakt mit %)
@('src\path\file1.cs','src\path\file2.cs') | %{ echo "=== $_ ==="; cat $_ } > output.txt

# Check for duplicate filenames
.\check-dupes.ps1

# Get complete file tree (3 modes)
.\Get-WisdomFileTree.ps1 -Mode Minimal   # Just paths
.\Get-WisdomFileTree.ps1 -Mode Compact   # By project
.\Get-WisdomFileTree.ps1 -Mode Detailed  # With metadata

# Settings Files sammeln
@('src\CamBridge.Config\Views\SettingsPage.xaml','src\CamBridge.Config\Views\SettingsPage.xaml.cs','src\CamBridge.Config\ViewModels\SettingsViewModel.cs') | %{ echo "=== $_ ==="; cat $_ } > settings-current.txt

# Pipeline Files sammeln (für v0.6.0)
@('src\CamBridge.Core\PipelineConfiguration.cs','src\CamBridge.Core\CamBridgeSettingsV2.cs','src\CamBridge.Config\Services\ConfigurationService.cs') | %{ echo "=== $_ ==="; cat $_ } > pipeline-current.txt

# Service Layer Files sammeln
@('src\CamBridge.Service\Worker.cs','src\CamBridge.Infrastructure\Services\FolderWatcherService.cs','src\CamBridge.Infrastructure\Services\ProcessingQueue.cs') | %{ echo "=== $_ ==="; cat $_ } > service-layer-current.txt

# QRBridge 2.0 testen
& "C:\Users\aiadmin\source\repos\CamBridge\Deploy\CamBridge-Deploy-v0.5.36\QRBridge\CamBridge.QRBridge.exe" -examid "TEST" -name "Test, Patient" -timeout 5

# Git Workflow für WISDOM Files
git add WISDOM_CLAUDE.md WISDOM_TECHNICAL.md
git commit --amend --no-edit
```

## 🚀 [KEEP] ENTWICKLUNGSFAHRPLAN

### ✅ Sprint 1-4: Core Development (DONE)
- Core Pipeline ✅
- Config UI ✅  
- Windows Service ✅
- Pipeline Testing ✅
- Encoding Fix ✅
- QRBridge 2.0 ✅
- FileTree System ✅

### ✅ Sprint 5: UI Polish & Easter Eggs (v0.5.35-v0.5.39) (DONE)
- **Sprint 5.1:** Marvin Easter Egg ✅
- **Sprint 5.2:** Settings System Fix ✅ 

### 🏗️ Sprint 6: Pipeline Architecture (v0.6.0-v0.6.5) ← WIR SIND HIER
- **Sprint 6.1:** Core Model & Migration ✅ (2025-06-06, 14:42)
- **Sprint 6.2:** Service Layer Updates ✅ (2025-06-06, 16:17)
- **Sprint 6.3:** Mapping Sets UI ← NEXT
- **Sprint 6.4:** Pipeline Configuration UI
- **Sprint 6.5:** Testing & Polish

### 🏥 Sprint 7: Medical Integration Phase 1 (v0.7.0-v0.7.5)
- DICOM Validation Enhancement
- Multi-Image Series Support
- Advanced Mapping Features
- Performance Optimization
- Error Recovery & Resilience

### 🛡️ Sprint 8: FTP Server [PROTECTED] (v0.8.0-v0.8.3)
- Basic FTP Server Implementation
- Secure FTP (FTPS) Support
- Auto-Import to Pipeline

### 🛡️ Sprint 9: C-STORE [PROTECTED] (v0.9.0-v0.9.3)
- DICOM C-STORE SCP Basic
- Multi-Connection Support
- Integration with Pipeline

### 🛡️ Sprint 10: MWL [PROTECTED] (v0.10.0-v0.10.3)
- MWL Query Implementation
- HIS/RIS Integration
- Auto-Population Features

### 🛡️ Sprint 11: C-FIND [PROTECTED] (v0.11.0-v0.11.3)
- DICOM Query (C-FIND) Basic
- PACS Integration
- Study Management

### 🏢 Sprint 12: Enterprise Features (v0.12.0-v0.12.5)
- Multi-Site Support
- Load Balancing
- High Availability
- Audit Logging
- Compliance Tools

### 🎯 Release: v1.0.0 (Q3 2025)
- Feature Complete ✅
- FDA 510(k) Ready ✅
- CE Mark Compliant ✅
- Full Documentation ✅
- Training Materials ✅

## ⏰ [KEEP] PROJEKT-TIMELINE

- **Start:** 30.05.2025
- **Pipeline fertig:** 04.06.2025, 14:28
- **Config UI fertig:** 05.06.2025, 01:30
- **Windows Service LÄUFT:** 05.06.2025, 15:15 🎉
- **One-Click Deploy:** 05.06.2025, 16:42 🎉
- **Encoding-Fix:** 05.06.2025, 19:15 ✅
- **QRBridge 2.0:** 05.06.2025, 22:30 🎯
- **FileTree System:** 06.06.2025, 00:30 🔍
- **Marvin Easter Egg:** 06.06.2025, 01:15 🤖
- **Settings System Fix:** 06.06.2025, 15:00 ✅
- **Pipeline Vision:** 06.06.2025, 15:30 🏗️
- **Pipeline Phase 1:** 06.06.2025, 14:42 ✅
- **Pipeline Phase 2:** 06.06.2025, 16:17 ✅
- **Arbeitszeit gesamt:** ~50 Stunden

## 📝 [KEEP] Standard Prompt für nächste Session

```
Ich arbeite an CamBridge v0.6.1.
Sprint 6.3: Mapping Sets UI für Pipeline Architecture

WICHTIG: Zuerst FileTree checken!
.\Get-WisdomFileTree.ps1

PIPELINE STATUS: Phase 1 & 2 abgeschlossen, jetzt Mapping UI
FEATURE CHECK: Sind FTP, C-STORE, MWL, C-FIND noch in der Roadmap?
```

## 🎯 Nächste Session Checkliste

1. **VOGON INIT** durchführen
2. **FileTree** checken (.\Get-WisdomFileTree.ps1)
3. **Pipeline Phase 3**: Mapping Sets UI
   - MappingEditorViewModel erweitern
   - Multiple Sets Support
   - Template System
4. **Feature Check** (4 Medical Features + Pipeline)
5. **Version** bei neuen Features erhöhen!

---

## 🏁 ENDE DES WISDOM_TECHNICAL

**Die technische Referenz für CamBridge Development**

*"Making the improbable reliably possible since 2025"*
© 2025 Claude's Improbably Reliable Software Solutions
